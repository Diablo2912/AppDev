{% extends "base.html" %}

{% block content %}

<!-- Edit here -->
<h1>Crop Calendar</h1>

<!-- FullCalendar integration -->
<div id='calendar'></div>

<script src='https://cdn.jsdelivr.net/npm/fullcalendar@6.1.15/index.global.min.js'></script>
<script>
  document.addEventListener('DOMContentLoaded', function() {
    var calendarEl = document.getElementById('calendar');

    var calendar = new FullCalendar.Calendar(calendarEl, {
      initialView: 'dayGridMonth',

      // Event click handler for modifying existing events
      eventClick: function(info) {
        // Prompt the user to edit the event title
        var newTitle = prompt("Edit event title:", info.event.title);

        // If the user changes the title, update it
        if (newTitle !== null) {
          info.event.setProp('title', newTitle);
        }

        // Prompt for a new end date
        var newEndDate = prompt("Enter the event's new end date (YYYY-MM-DD):", info.event.end ? info.event.end.toISOString().split('T')[0] : info.event.start.toISOString().split('T')[0]);

        // If a new end date is provided, update it
        if (newEndDate) {
          info.event.setEnd(newEndDate);
        } else {
          alert("End date is required.");
        }
      },

      // Event click handler for creating new events
      dateClick: function(info) {
        // Prompt the user to enter event title
        var eventTitle = prompt("Enter event title:");

        // If a title is entered, proceed to ask for start and end dates
        if (eventTitle) {
          // Prompt the user for the event's end date
          var startDate = info.dateStr; // The date user clicked on
          var endDate = prompt("Enter the event's end date (YYYY-MM-DD):");

          // Validate that the end date is entered correctly
          if (endDate) {
            // Add the event with start and end dates
            calendar.addEvent({
              title: eventTitle,
              start: startDate,  // Use the clicked date as the start date
              end: endDate,      // Use the entered end date
              allDay: true        // Mark as an all-day event
            });
          } else {
            alert("End date is required.");
          }
        }
      }
    });

    calendar.render();
  });
</script>
<!-- FullCalendar integration ends -->

<!-- To here -->

{% endblock %}